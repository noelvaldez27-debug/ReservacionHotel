@using ReserHotel.Controllers
@model IEnumerable<ReservaListItem>
@{
 ViewData["Title"] = "Reservas";
}
<div class="container mt-4">
 <h2>Reservas</h2>
 <div class="mb-3 d-flex justify-content-end gap-2">
 <a class="btn btn-primary btn-sm" href="@Url.Action("Search")">Nueva Reserva</a>
 </div>
 @if (TempData["Success"] != null){<div class="alert alert-success">@TempData["Success"]</div>}
 @if (TempData["Error"] != null){<div class="alert alert-danger">@TempData["Error"]</div>}
 <div class="table-responsive">
 <table class="table table-striped align-middle">
 <thead>
 <tr>
 <th>Nombre</th>
 <th>Número</th>
 <th>Piso</th>
 <th>Tipo</th>
 <th>Capacidad</th>
 <th>Amenidades</th>
 <th></th>
 </tr>
 </thead>
 <tbody>
 @foreach (var r in Model)
 {
 var nombreHab = r.Habitacion?.RegistradoNombreCompleto ?? "";
 <tr>
 <td>@nombreHab</td>
 <td>@r.Habitacion?.Numero</td>
 <td>@r.Habitacion?.Piso</td>
 <td>@r.Habitacion?.Tipo</td>
 <td>@r.Habitacion?.Capacidad</td>
 <td>@r.Habitacion?.Amenidades</td>
 <td class="text-end">
 <!-- Acciones de la reserva -->
 <form asp-action="Cancel" method="post" asp-route-id="@r.Reserva.Id" class="d-inline" onsubmit="return confirm('Cancelar esta reserva?');">
 <button type="submit" class="btn btn-sm btn-outline-danger" @(r.Reserva.Estado==HotelSystem.Domain.Entities.EstadoReserva.Cancelada?"disabled":"")>Cancelar</button>
 </form>
 <form asp-action="CheckIn" method="post" asp-route-id="@r.Reserva.Id" class="d-inline" onsubmit="return confirm('Confirmar check-in?');">
 <button type="submit" class="btn btn-sm btn-outline-success" @(r.Reserva.Estado!=HotelSystem.Domain.Entities.EstadoReserva.Pendiente?"disabled":"")>Check-In</button>
 </form>
 <form asp-action="CheckOut" method="post" asp-route-id="@r.Reserva.Id" class="d-inline" onsubmit="return confirm('Procesar check-out?');">
 <button type="submit" class="btn btn-sm btn-outline-primary" @(r.Reserva.Estado!=HotelSystem.Domain.Entities.EstadoReserva.Confirmada?"disabled":"")>Check-Out</button>
 </form>
 <!-- Acciones sobre la habitación vinculada -->
 @if (r.Habitacion is not null)
 {
 <a class="btn btn-sm btn-outline-info" href="@Url.Action("Details", "Habitaciones", new { id = r.Habitacion.Id })">Detalles</a>
 <a class="btn btn-sm btn-outline-warning" href="@Url.Action("Edit", "Habitaciones", new { id = r.Habitacion.Id })">Editar</a>
 <a class="btn btn-sm btn-outline-danger" href="@Url.Action("Delete", "Habitaciones", new { id = r.Habitacion.Id })">Eliminar</a>
 }
 </td>
 </tr>
 }
 </tbody>
 </table>
 </div>
</div>